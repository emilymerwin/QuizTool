<!DOCTYPE html>
<html>
<head>
<title>Can you guess whatâ€™s wrong?</title>
<base target="_parent"/>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<link rel=stylesheet href="assets/quizstyle2.css" type="text/css"/>
<link rel=stylesheet href="assets/quizstyle_testing.css" type="text/css"/>
<link rel="stylesheet" href="http://host.coxmediagroup.com/ajc/digitalprojects/global/css/iFrame_Medley.css" type="text/css"/>
<style type="text/css">
#finalResults, #resultsBox{
	display:none;
}
</style>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">
var url = window.location.toString();
var query_string = url.split("?");

$(window).load(function(){  
	$.get('forms_js/'+query_string[1]+'.js', function(){
		var count = 0, tooFar = 0, slideWidth = $('#quizHolder').width();
		var myContent = document.getElementById('questions');
		myContent.innerHTML = "";
		var numQs = qArray.length;
		var ansKeyArr = ["A", "B", "C", "D", "E"];
		for (var q=0; q<numQs; q++){
			var tempQ = qArray[q];
			myContent.innerHTML+= '<div class="q"><div class="questions" id="question'+q+'"><span class="cmSource">Question '+(q+1)+'/'+numQs+':</span><p> '+tempQ.question+'</p></div><div id="answer'+q+'"></div></div>'; 
			var myAnswerHolder = document.getElementById('answer'+q);
			myAnswerHolder.innerHTML = "";

			for (var i=0;i<tempQ.answerArr.length;i++){
					var ansKey = ansKeyArr[i];
					myAnswerHolder.innerHTML += '<div class="answers btn" id="'+q+'_'+ansKey+'">'+ansKey+": "+tempQ.answerArr[i]+'</div>';
			}
		}
		$('.answers').click(function(event){
			var target = event.target || event.srcElement;
			$('#'+target.id).css({'background-color':'#ccc'});
			check2(target, event);
		});
		function check2(target, event){
			var id = target.id;
			var tempArr = id.split("_");
			var myObj = qArray[parseInt(tempArr[0])];//which object do we need to look at?
			var selectedAns = tempArr[1]//which answer was selected
			var responseTxt, borderColor;
			if(myObj.correct === selectedAns){
				count++;
				borderColor = '#FFBA33';
				if(tempArr[0] === "0"){
					responseTxt = 'According to the state, this is the right answer, though it';
				}
				else{
					responseTxt = 'You got it right, but this answer';
				}
			} else{
				borderColor = '#f00';
				if(tempArr[0] === "0"){
					responseTxt = 'According to the state, the correct answer should have been "E", though it';
				}
				else{
					responseTxt = 'The correct answer should have been "'+myObj.correct+'", though it';
				}
			}
			$('#response').empty().append('<p><strong>'+responseTxt+' wasn\'t an option on the actual test.</strong></p><br><p>'+myObj.explanation+'</p><p class="cmSource">'+myObj.sourced+'</p>').css({'border-color':borderColor});
			$('#resultsBox').show();
			goNext();
		}//check2

		function goNext() {
			tooFar = $('#slider').position();
			if(tooFar.left !== -((numQs-1)*slideWidth)) {
				$('#next').click(function(){
					$('#resultsBox').hide();
					$('#slider').animate({left: tooFar.left-slideWidth});
				});
			} else {
				countFinal();
			};
		}//goNext

		//count final score and give final results
		function countFinal(){
			$('#finalResults').show();
			$('#finalResults').append('<div id="yourScore">Your score: '+count+'/'+numQs+'</div><div id="scoreResponse"><p>Georgia education officials demanded that the first three questions be removed from high school End-of-Course Tests. In a separate incident, officials first ordered a different contractor to drop the fourth question, but then agreed to allow it to be counted in scores. More problems later surfaced with that test and it was eventually invalidated.</p></div>');
		};//countFinal
	});//get
});//window.log
</script>
</head>
<body>
	<div id="quizHolder">
		<div id="slider">
			<div id="questions"></div>
			<div class="q" id="finalResults"></div>
		</div>
		<div id="resultsBox">
			<div id="response"></div>
			<div id="next" class="btn">next</div>
		</div>
	</div>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-28102445-3']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
</script>
</body>
</html>