<!DOCTYPE html>
<html>
<head>
<title>Can you guess whatâ€™s wrong?</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<link rel=stylesheet href="assets/quizstyle_testing.css" type="text/css"/>
<link rel="stylesheet" href="http://host.coxmediagroup.com/ajc/digitalprojects/global/css/iFrame_Medley.css" type="text/css"/>
<style type="text/css">
#finalResults, #resultsBox{
	display:none;
}
</style>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript" src="assets/jquery.touchSwipe.js"></script>
<script type="text/javascript">
var url = window.location.toString();
var query_string = url.split("?");

$(window).load(function(){  
	$.get('forms_js/'+query_string[1]+'.js', function(){
		var count = 0, tooFar = 0;
		//document.getElementById('quizTitle').innerHTML = quizTitle;
		var myContent = document.getElementById('questions');
		myContent.innerHTML = "";
		var numQs = qArray.length;
		var ansKeyArr = ["A", "B", "C", "D", "E"];
		for (var q=0; q<numQs; q++){
			var tempQ = qArray[q];
			myContent.innerHTML+= '<div class="q"><div class="questions" id="question'+q+'"><span class="cmSource">Question '+(q+1)+'/'+numQs+':</span><p> '+tempQ.question+'</p></div><div id="answer'+q+'" class="answerHolder"></div></div>'; 
			var myAnswerHolder = document.getElementById('answer'+q);
			myAnswerHolder.innerHTML = "";

			for (var i=0;i<tempQ.answerArr.length;i++){
				if(tempQ.answerArr[i] !== ""){//if question has fewer than 4 answer choices they will populate through the form as "" so we can't use the length property
					var ansKey = ansKeyArr[i];
					myAnswerHolder.innerHTML += '<div class="answers btn" id="'+q+'_'+ansKey+'" >'+tempQ.answerArr[i]+'</div>';
				}
			}
			if(tempQ.img !== ""){$(document.getElementById('question'+q)).parent().append('<div id="img'+q+'" class="images"><img src="'+tempQ.img+'"/></div>')};
			if(tempQ.pcred !== ""){document.getElementById('img'+q).innerHTML+= '<p class="cmSource">'+tempQ.pcred+'</p>'}
		}
		$('.answers').click(function(event){
			var target = event.target || event.srcElement;
			$('#'+target.id).css({'background-color':'#ccc'});
			check2(target, event);
		});
		function check2(target, event){
			var id = target.id;
			var tempArr = id.split("_");
			var myObj = qArray[parseInt(tempArr[0])];//which object do we need to look at?
			var selectedAns = tempArr[1]//which answer was selected
			if(myObj.correct === selectedAns){
				count++;
				//$('#response').empty().append('<div class="correctAnswer">The answer "'+$('#'+id).text()+'" is correct!</div><br><p>'+myObj.explanation+'</p>').css({'border-color':'#22b652'});
				$('#response').empty().append('<div class="correctAnswer">You got it right, but this answer wasn\'t an option on the actual test.</div><br><p>'+myObj.explanation+'</p><p class="cmSource">'+myObj.sourced+'</p>').css({'border-color':'#FFBA33'});
			} else{
				$('#response').empty().append('<div class="correctAnswer">The correct answer should have been "'+$(('#'+tempArr[0]+"_"+myObj.correct)).text()+'", even though that wasn\'t an option on the test.</div><br><p>'+myObj.explanation+'</p><p class="cmSource">'+myObj.sourced+'</p>').css({'border-color':' #f00'});//come back to this
			}
			if(myObj.URL !== ""){
				$('#response').append('<p><a href="'+myObj.URL+'" target="_blank">Read the story</a></p>');
			}
			$('#resultsBox').show();
			goNext();
		}//check2

		function goNext() {
			tooFar = $('#slider').position();
			if(tooFar.left !== -((numQs-1)*600)) {
				$('#next').click(function(){
					$('#resultsBox').hide();
					$('#slider').animate({left: tooFar.left-600});
				});
			} else {
				countFinal();
			};
		}//goNext

		//count final score and give final results
		function countFinal(){
			$('#finalResults').show();
			/*var finalCount = Math.round((count/numQs)*100);
			if (finalCount > 80) {
				resultText = "Nice job!";
			} else if(finalCount >= 60) {
				resultText = "So close! You should try again.";
			} else if(finalCount >= 40) {
				resultText = "Hmm. You could do much better.";
			} else if(finalCount >= 20) {
				resultText = "Not so hot. Maybe next time?";
			} else {
				resultText = "Do you pay attention at <i>all</i>?";
			}*/
			$('#scoreResponse').empty().append("<p>Georgia education officials demanded that the first three questions be removed from high school End-of-Course Tests. In a separate incident, officials first ordered a different contractor to drop the fourth question, but then agreed to allow it to be counted in scores. More problems later surfaced with that test and it was eventually invalidated.</p>");//why do we have empty on these? Is it because we used to play the same game with try again
			$('#yourScore').empty().append('Your score: '+count+'/'+numQs);
			$('#score').empty().append(finalCount+'%');
		/*	$('#tryAgain').click(function(event){
				window.parent.location.reload();
			});*/
		};//countFinal
	});//get
});//window.log
</script>
</head>
<body>
	<!--<div id="quizTitle"></div>
	<p>Forget about the answers, can you spot the problems with the following test questions? All appeared on actual exams given to Georgia students.</p>-->
	<div id="quizBackground"></div>
	<div id="quizHolder">
		<div id="slider">
			<div id="questions"></div>
			<div class="q" id="finalResults">
				<div id="yourScore"></div>
				<div id="scoreResponse"></div>
				<!--<div id="tryAgain" class="btn">TRY AGAIN?</div>-->
			</div>
		</div>
		<div id="resultsBox">
			<div id="response"></div>
			<div id="next" class="btn">next</div>
		</div>
	</div>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-28102445-3']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
</script>
</body>
</html>